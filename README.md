# PixelLight

<img src="app/images/icon.svg" alt="app icon" width="72" />

![latest release badge](https://img.shields.io/github/v/release/chenxiaolong/PixelLight?sort=semver)
![license badge](https://img.shields.io/github/license/chenxiaolong/PixelLight)

PixelLight is a bare-bones flashlight app for Google Pixel devices that can access higher brightness levels than what is typically allowed by the standard Android 13+ torch APIs.

It allows access to the same brightness levels as Google Magnifier, except without the excessive 200% CPU usage due to constant camera processing. However, due to how the Pixel private API works, avoiding camera processing entirely is not possible. The CPU usage while the flashlight is on will generally hover around 25%.

## Features

* Supports entire brightness range
* Quick settings tile
* Tiny APK with no dependencies

## Limitations

* Only supports Android 15+. For Android 12-14, use the old PixelLight 1.0 release, which has a better user experience due to fewer Android restrictions.
* On Android 15, the quick settings tile requires unlocking the device when used on the lock screen. The quick settings panel will also close when tapping on the tile. These are not fixable due to Android 15's new restrictions on starting foreground services.

  However, if the "Keep service alive" option is enabled, then these restrictions only apply the first time the tile is toggled after a reboot. This keeps the foreground service running indefinitely, but does not impact battery life because the service is completely idle and not executing any code. The mandatory notification can be disabled from Android's settings if desired.

## Permissions

The `CAMERA` permission is required because Pixel's private API for high brightness modes is only accessible when using the camera as a camera, not when using the camera as a flashlight with the official Android 13+ APIs. Internally, PixelLight is taking a picture every time the flashlight is turned on or the brightness is changed. These exist only in memory and are never saved to disk.

The `FOREGROUND_SERVICE` and `POST_NOTIFICATIONS` permissions are required to allow the flashlight to remain on while the app is in the background. They are also required for the quick settings tile to work.

PixelLight does not and will never have the `INTERNET` permission.

## Verifying digital signatures

First, use `apksigner` to print the digests of the APK signing certificate:

```
apksigner verify --print-certs PixelLight-<version>-release.apk
```

Then, check that the SHA-256 digest of the APK signing certificate is:

```
03a9ed333be772cf612af84fc4bf2cc95428ff5a10c057d3b60d86b0f8fec2c3
```

## Building from source

PixelLight can be built like most other Android apps using Android Studio or the gradle command line.

To build the APK:

```bash
./gradlew assembleDebug
```

The APK will be signed with the default autogenerated debug key.

To create a release build with a specific signing key, set the following environment variables:

```bash
export RELEASE_KEYSTORE=/path/to/keystore.jks
export RELEASE_KEY_ALIAS=alias_name

read -r -s RELEASE_KEYSTORE_PASSPHRASE
read -r -s RELEASE_KEY_PASSPHRASE
export RELEASE_KEYSTORE_PASSPHRASE
export RELEASE_KEY_PASSPHRASE
```

and then build the release APK:

```bash
./gradlew assembleRelease
```

## Contributing

Bug fix and translation pull requests are welcome and much appreciated!

However, aside from that, PixelLight will only ever support Google Pixel devices and is intentionally featureless. I am unlikely to implement any new features.

## License

PixelLight itself is licensed under GPLv3. Please see [`LICENSE`](./LICENSE) for the full license text.
